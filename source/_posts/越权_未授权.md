---
layout:     post   				    # 使用的布局（不需要改）
title:      越权			    # 标题 
categories: SRC                        # 分类
date:       2024-12-03 				# 时间
author:     z1 						# 作者
catalog: true 						# 是否归档
tags:								# 标签
    - src
    - 越权
description: 对越权/未授权漏洞挖掘思路的总结
---
# 越权漏洞

## 水平越权

### 测试思路

1. 考虑 ***增删改查*** 四个功能点,对于所有数据,都应该包含这四个功能. 简单来说, 页面内肉眼可见的功能点都要去测, 尤其是页面中存在的独特的功能点, 要多加注意

2. bp里面开启自动替换，设置规则，一般是 `false -> true`,这种方法对于测试存在两步鉴权的网站非常有用

   > &#x2139;&#xfe0f;**提示**
   >
   > **两步鉴权**(也可以理解为前端鉴权): 有些站点中, 在用户使用某个功能时, 前端会先发起一个请求, 询问后端当前用户是否有使用该功能的权限, 如果有,则调用该功能的接口; 否则,提示用户无权限. 但是该功能接口并没有对用户权限进行校验. 这种情况下, 可以通过修改返回包中的false为true, 从而欺骗前端, 让前端误以为用户有操作该功能的权限, 进一步达到越权.

3. 有些网站的同一个功能点出现在不同位置, 这些相同的功能点可能对应不同的接口, 这种情况下就可能存在越权

4. 有些站点存在上传功能点, 对于上传的数据包(***尤其是批量上传***)要仔细分析, 查看是否存在越权上传, 即把数据上传到其他账号下

## 垂直越权

### 1. 获取账号

1. 手动创建账号

   创建两个不同权限的账号

2. 没有创建账号的功能

   对系统进行越权

### 2. 测试

1. 子主账号场景

   记录主账号关键操作的请求包，再替换鉴权字段值为子账号

2. 单账号场景

## 401 绕过

- 路径中双写斜杠 `/` 
- [GitHub - 0x727/BypassPro: 401绕过自动化bp插件](https://github.com/0x727/BypassPro)

## 未授权测试方法

### 1. 响应改请求

有些情况下响应数据包中会返回json格式的数据，这时候可以把响应体中的数据放到请求体中，修改其中部分字段值，测试是否可以读取数据

### 2. 修改响应头中的鉴权字段值

如 set-cookie 中的 userid(**这个userid是出现在响应头中的**),这是后可以把响应头中的userid值改成其他用户的值

### 3. 参数操作

- [未授权之参数变换](/2025/08/27/未授权之参数变换/)

- 将测试对象的id值修改为其他对象的值

- 参数值置空

- 删去参数和参数值

- 参数值改成0, -1

- uid=1234 -> uid=$uid$

- uid=$uid$ -> uid=3282

  > &#x2139;&#xfe0f;**提示**
  >
  > `$$` 表示占位符,不同站点占位符可能不一样,有的可能是`{{}}` 或者`{}`
