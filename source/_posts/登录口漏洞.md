---
layout:     post   				    # 使用的布局（不需要改）
title:      登录口漏洞 				    # 标题
categories: SRC                        # 分类
date:       2024-11-08 				# 时间
author:     z1 						# 作者
catalog: true 						# 是否归档
tags:								# 标签
    - src
description: 登录口漏洞挖掘方法
---
# 登录口漏洞

## 场景

1. 登录

   任意用户登录，弱口令，万能密码，session模拟登录，Js审查（代码中存在密码泄露）

2. 注册

   如果没有提供注册功能，可以尝试手动构造注册接口

   任意用户注册（注册已存在账户造成账号接管）

3. 密码重置

   任意用户密码重置，默认密码，session覆盖

4. 验证码

   短信，图片，邮箱三类验证码

## 任意用户登录

- 常见

  - 手机号和验证码未绑定：用自己手机号接收验证码之后，改成其他手机号
  - 一值传多参：加逗号，一个值带多个参数
  - 多值混淆：mobile=153xxxx&mobile=134xxxxx

- 第三方

  - 第三方软件登录：微博/微信/qq -- wxid：xxxx(根据wxid识别账户)
  - 第三方软件登录：微博/微信/qq -- userid：xxxx(根据userid识别账户)
  - 登录状态下点击授权：点击后携带参数

  *对这些登录过程进行抓包*

- 其他

  登录无二次验证

## 任意用户注册

- 邮箱发送激活链接注册

  - 信息填写完成后的返回包存在泄露 active code 或 激活id
  - 信息填写完成后跳转等待激活页面存在泄露active code 或 激活id
  
- 尝试注册高权限账号（利用企业域名注册企业邮箱等）

  注册的账号权限越高，越好挖。
  
  - xxxx@企业域名
  - whois查询手机号邮箱

## 短信验证码

- 短信轰炸

  ```tex
  %09
  %0a
  %0c
  %0d
  %0b
  %a0
  +86
  ```

  *+86 如果在界面中没有显示，但是抓包时有可以修改从而绕过*

- 验证码复用：填正确的验证码发送到repeater模块一直重放，若是不提示验证码错误而一直提示账密错误则存在验证码复用即验证码不过期

- 验证码爆破：4，6位都可作为漏洞提交，只要公告中没有明确说明不收

  6位的话，先接收一个，然后在这一个验证码上下1000个以内利用bp爆破

- 报错回显：填写错误的，响应数据包中存在正确的验证码

- 绑定关系失效

  - 手机号与验证码未绑定
  - 双写绕过
    - 手机号参数写两个手机号，用 `,` 或 `空格` 或 `|` 隔开
    - 传入两个手机号参数

- 修改参数

  - 状态码
  - 鉴权相应参数
  - 改 `true` 

- 删除验证码字段

- 同意初始化：测试 `0000` `none` `true` `1111` `null` 置空

## 密码重置

- 不验证原密码&原密码可绕过


  +csrf 提高危害，构造链接让受害者访问达到用户密码重置。
